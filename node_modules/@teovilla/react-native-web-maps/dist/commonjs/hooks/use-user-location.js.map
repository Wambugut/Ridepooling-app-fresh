{"version":3,"names":["Location","_interopRequireWildcard","require","_react","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","useUserLocation","options","location","setLocation","useState","watchPositionSubscription","setWatchPositionSubscription","permission","useForegroundPermissions","request","requestPermission","showUserLocation","handleLocationChange","useCallback","e","_options$onUserLocati","onUserLocationChange","nativeEvent","coordinate","coords","timestamp","Date","now","altitude","heading","accuracy","Accuracy","Balanced","isFromMockProvider","mocked","speed","useEffect","granted","followUserLocation","getCurrentPositionAsync","then","watchPositionAsync","remove"],"sources":["use-user-location.tsx"],"sourcesContent":["import * as Location from 'expo-location';\nimport { useCallback, useEffect, useState } from 'react';\nimport type { UserLocationChangeEvent } from 'react-native-maps';\n\ninterface UseUserLocationOptions {\n  requestPermission: boolean;\n  onUserLocationChange?(e: UserLocationChangeEvent): void;\n  followUserLocation: boolean;\n  showUserLocation: boolean;\n}\n\nexport function useUserLocation(options: UseUserLocationOptions) {\n  const [location, setLocation] = useState<Location.LocationObject>();\n\n  const [watchPositionSubscription, setWatchPositionSubscription] =\n    useState<Location.LocationSubscription>();\n\n  const [permission] = Location.useForegroundPermissions({\n    request: options.requestPermission,\n    get: options.showUserLocation,\n  });\n\n  const handleLocationChange = useCallback(\n    function (e: Location.LocationObject) {\n      setLocation(e);\n      options.onUserLocationChange?.({\n        nativeEvent: {\n          coordinate: {\n            ...e.coords,\n            timestamp: Date.now(),\n            altitude: e.coords.altitude || 0,\n            heading: e.coords.heading || 0,\n            accuracy: e.coords.accuracy || Location.Accuracy.Balanced,\n            isFromMockProvider: e.mocked || false,\n            speed: e.coords.speed || 0,\n          },\n        },\n      } as unknown as UserLocationChangeEvent);\n    },\n    [options.onUserLocationChange]\n  );\n\n  useEffect(() => {\n    if (permission?.granted && options.followUserLocation) {\n      Location.getCurrentPositionAsync().then(handleLocationChange);\n      // Watch position\n      Location.watchPositionAsync(\n        { accuracy: Location.Accuracy.Balanced },\n        handleLocationChange\n      ).then(setWatchPositionSubscription);\n    }\n\n    return () => watchPositionSubscription?.remove();\n  }, [permission, options.followUserLocation]);\n\n  return location;\n}\n"],"mappings":"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"}