{"version":3,"names":["Location","useCallback","useEffect","useState","useUserLocation","options","location","setLocation","watchPositionSubscription","setWatchPositionSubscription","permission","useForegroundPermissions","request","requestPermission","get","showUserLocation","handleLocationChange","e","_options$onUserLocati","onUserLocationChange","call","nativeEvent","coordinate","coords","timestamp","Date","now","altitude","heading","accuracy","Accuracy","Balanced","isFromMockProvider","mocked","speed","granted","followUserLocation","getCurrentPositionAsync","then","watchPositionAsync","remove"],"sources":["use-user-location.tsx"],"sourcesContent":["import * as Location from 'expo-location';\nimport { useCallback, useEffect, useState } from 'react';\nimport type { UserLocationChangeEvent } from 'react-native-maps';\n\ninterface UseUserLocationOptions {\n  requestPermission: boolean;\n  onUserLocationChange?(e: UserLocationChangeEvent): void;\n  followUserLocation: boolean;\n  showUserLocation: boolean;\n}\n\nexport function useUserLocation(options: UseUserLocationOptions) {\n  const [location, setLocation] = useState<Location.LocationObject>();\n\n  const [watchPositionSubscription, setWatchPositionSubscription] =\n    useState<Location.LocationSubscription>();\n\n  const [permission] = Location.useForegroundPermissions({\n    request: options.requestPermission,\n    get: options.showUserLocation,\n  });\n\n  const handleLocationChange = useCallback(\n    function (e: Location.LocationObject) {\n      setLocation(e);\n      options.onUserLocationChange?.({\n        nativeEvent: {\n          coordinate: {\n            ...e.coords,\n            timestamp: Date.now(),\n            altitude: e.coords.altitude || 0,\n            heading: e.coords.heading || 0,\n            accuracy: e.coords.accuracy || Location.Accuracy.Balanced,\n            isFromMockProvider: e.mocked || false,\n            speed: e.coords.speed || 0,\n          },\n        },\n      } as unknown as UserLocationChangeEvent);\n    },\n    [options.onUserLocationChange]\n  );\n\n  useEffect(() => {\n    if (permission?.granted && options.followUserLocation) {\n      Location.getCurrentPositionAsync().then(handleLocationChange);\n      // Watch position\n      Location.watchPositionAsync(\n        { accuracy: Location.Accuracy.Balanced },\n        handleLocationChange\n      ).then(setWatchPositionSubscription);\n    }\n\n    return () => watchPositionSubscription?.remove();\n  }, [permission, options.followUserLocation]);\n\n  return location;\n}\n"],"mappings":"AAAA,OAAO,KAAKA,QAAQ,MAAM,eAAe;AACzC,SAASC,WAAW,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAUxD,OAAO,SAASC,eAAeA,CAACC,OAA+B,EAAE;EAC/D,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGJ,QAAQ,CAA0B,CAAC;EAEnE,MAAM,CAACK,yBAAyB,EAAEC,4BAA4B,CAAC,GAC7DN,QAAQ,CAAgC,CAAC;EAE3C,MAAM,CAACO,UAAU,CAAC,GAAGV,QAAQ,CAACW,wBAAwB,CAAC;IACrDC,OAAO,EAAEP,OAAO,CAACQ,iBAAiB;IAClCC,GAAG,EAAET,OAAO,CAACU;EACf,CAAC,CAAC;EAEF,MAAMC,oBAAoB,GAAGf,WAAW,CACtC,UAAUgB,CAA0B,EAAE;IAAA,IAAAC,qBAAA;IACpCX,WAAW,CAACU,CAAC,CAAC;IACd,CAAAC,qBAAA,GAAAb,OAAO,CAACc,oBAAoB,cAAAD,qBAAA,uBAA5BA,qBAAA,CAAAE,IAAA,CAAAf,OAAO,EAAwB;MAC7BgB,WAAW,EAAE;QACXC,UAAU,EAAE;UACV,GAAGL,CAAC,CAACM,MAAM;UACXC,SAAS,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC;UACrBC,QAAQ,EAAEV,CAAC,CAACM,MAAM,CAACI,QAAQ,IAAI,CAAC;UAChCC,OAAO,EAAEX,CAAC,CAACM,MAAM,CAACK,OAAO,IAAI,CAAC;UAC9BC,QAAQ,EAAEZ,CAAC,CAACM,MAAM,CAACM,QAAQ,IAAI7B,QAAQ,CAAC8B,QAAQ,CAACC,QAAQ;UACzDC,kBAAkB,EAAEf,CAAC,CAACgB,MAAM,IAAI,KAAK;UACrCC,KAAK,EAAEjB,CAAC,CAACM,MAAM,CAACW,KAAK,IAAI;QAC3B;MACF;IACF,CAAuC,CAAC;EAC1C,CAAC,EACD,CAAC7B,OAAO,CAACc,oBAAoB,CAC/B,CAAC;EAEDjB,SAAS,CAAC,MAAM;IACd,IAAIQ,UAAU,aAAVA,UAAU,eAAVA,UAAU,CAAEyB,OAAO,IAAI9B,OAAO,CAAC+B,kBAAkB,EAAE;MACrDpC,QAAQ,CAACqC,uBAAuB,CAAC,CAAC,CAACC,IAAI,CAACtB,oBAAoB,CAAC;MAC7D;MACAhB,QAAQ,CAACuC,kBAAkB,CACzB;QAAEV,QAAQ,EAAE7B,QAAQ,CAAC8B,QAAQ,CAACC;MAAS,CAAC,EACxCf,oBACF,CAAC,CAACsB,IAAI,CAAC7B,4BAA4B,CAAC;IACtC;IAEA,OAAO,MAAMD,yBAAyB,aAAzBA,yBAAyB,uBAAzBA,yBAAyB,CAAEgC,MAAM,CAAC,CAAC;EAClD,CAAC,EAAE,CAAC9B,UAAU,EAAEL,OAAO,CAAC+B,kBAAkB,CAAC,CAAC;EAE5C,OAAO9B,QAAQ;AACjB"}